<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 450">
  <defs>
    <linearGradient id="dsonLineGrad" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#e74c3c"/>
      <stop offset="100%" style="stop-color:#c0392b"/>
    </linearGradient>
    <linearGradient id="simdLineGrad" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#27ae60"/>
      <stop offset="100%" style="stop-color:#1e8449"/>
    </linearGradient>
  </defs>

  <!-- Background -->
  <rect width="900" height="450" fill="#fafafa"/>

  <!-- Title -->
  <text x="450" y="30" text-anchor="middle" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="#2c3e50">
    Schema Selectivity Impact: serde vs fionn
  </text>
  <text x="450" y="50" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#7f8c8d">
    10KB document · Parsing + merge latency by % of fields accessed
  </text>

  <!-- Chart area -->
  <g transform="translate(100, 80)">
    <!-- Axes -->
    <line x1="0" y1="0" x2="0" y2="280" stroke="#bdc3c7" stroke-width="2"/>
    <line x1="0" y1="280" x2="650" y2="280" stroke="#bdc3c7" stroke-width="2"/>

    <!-- Y-axis labels (latency) -->
    <text x="-10" y="280" text-anchor="end" font-family="Arial, sans-serif" font-size="10" fill="#7f8c8d">0</text>
    <text x="-10" y="224" text-anchor="end" font-family="Arial, sans-serif" font-size="10" fill="#7f8c8d">1 µs</text>
    <text x="-10" y="168" text-anchor="end" font-family="Arial, sans-serif" font-size="10" fill="#7f8c8d">2 µs</text>
    <text x="-10" y="112" text-anchor="end" font-family="Arial, sans-serif" font-size="10" fill="#7f8c8d">3 µs</text>
    <text x="-10" y="56" text-anchor="end" font-family="Arial, sans-serif" font-size="10" fill="#7f8c8d">4 µs</text>
    <text x="-10" y="0" text-anchor="end" font-family="Arial, sans-serif" font-size="10" fill="#7f8c8d">5 µs</text>

    <text x="-50" y="140" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#2c3e50" transform="rotate(-90, -50, 140)">
      Latency (µs)
    </text>

    <!-- X-axis labels (selectivity) -->
    <text x="0" y="300" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#7f8c8d">1%</text>
    <text x="130" y="300" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#7f8c8d">10%</text>
    <text x="260" y="300" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#7f8c8d">25%</text>
    <text x="390" y="300" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#7f8c8d">50%</text>
    <text x="520" y="300" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#7f8c8d">75%</text>
    <text x="650" y="300" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#7f8c8d">100%</text>

    <text x="325" y="325" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#2c3e50">
      Schema Selectivity (% of fields in schema)
    </text>

    <!-- Gridlines -->
    <line x1="0" y1="224" x2="650" y2="224" stroke="#ecf0f1" stroke-width="1"/>
    <line x1="0" y1="168" x2="650" y2="168" stroke="#ecf0f1" stroke-width="1"/>
    <line x1="0" y1="112" x2="650" y2="112" stroke="#ecf0f1" stroke-width="1"/>
    <line x1="0" y1="56" x2="650" y2="56" stroke="#ecf0f1" stroke-width="1"/>

    <line x1="130" y1="0" x2="130" y2="280" stroke="#ecf0f1" stroke-width="1"/>
    <line x1="260" y1="0" x2="260" y2="280" stroke="#ecf0f1" stroke-width="1"/>
    <line x1="390" y1="0" x2="390" y2="280" stroke="#ecf0f1" stroke-width="1"/>
    <line x1="520" y1="0" x2="520" y2="280" stroke="#ecf0f1" stroke-width="1"/>

    <!-- serde line: constant ~4.16 µs (parses everything regardless of selectivity) -->
    <line x1="0" y1="47" x2="650" y2="47" stroke="#e74c3c" stroke-width="3"/>
    <text x="660" y="51" font-family="Arial, sans-serif" font-size="10" fill="#c0392b" font-weight="bold">serde: 4.16 µs</text>
    <text x="660" y="65" font-family="Arial, sans-serif" font-size="9" fill="#c0392b">(always parses all)</text>

    <!-- fionn line: scales with selectivity -->
    <!-- 1%: 0.12 µs, 10%: 0.38 µs, 25%: 0.65 µs, 50%: 0.92 µs, 75%: 1.2 µs, 100%: 1.60 µs -->
    <path d="M 0,273 L 130,259 L 260,244 L 390,228 L 520,213 L 650,190"
          fill="none" stroke="#27ae60" stroke-width="3"/>

    <!-- Data points for fionn -->
    <circle cx="0" cy="273" r="6" fill="#27ae60"/>
    <text x="15" y="270" font-family="Arial, sans-serif" font-size="9" fill="#1e8449" font-weight="bold">0.12µs</text>

    <circle cx="130" cy="259" r="5" fill="#27ae60"/>
    <text x="140" y="256" font-family="Arial, sans-serif" font-size="9" fill="#1e8449">0.38µs</text>

    <circle cx="260" cy="244" r="5" fill="#27ae60"/>
    <text x="270" y="241" font-family="Arial, sans-serif" font-size="9" fill="#1e8449">0.65µs</text>

    <circle cx="390" cy="228" r="5" fill="#27ae60"/>
    <text x="400" y="225" font-family="Arial, sans-serif" font-size="9" fill="#1e8449">0.92µs</text>

    <circle cx="520" cy="213" r="5" fill="#27ae60"/>
    <text x="530" y="210" font-family="Arial, sans-serif" font-size="9" fill="#1e8449">1.2µs</text>

    <circle cx="650" cy="190" r="6" fill="#27ae60"/>
    <text x="545" y="185" font-family="Arial, sans-serif" font-size="9" fill="#1e8449" font-weight="bold">fionn: 1.60µs</text>

    <!-- Speedup annotations -->
    <line x1="0" y1="47" x2="0" y2="273" stroke="#9b59b6" stroke-width="1" stroke-dasharray="4,2"/>
    <text x="10" y="160" font-family="Arial, sans-serif" font-size="11" fill="#9b59b6" font-weight="bold">35×</text>

    <line x1="130" y1="47" x2="130" y2="259" stroke="#9b59b6" stroke-width="1" stroke-dasharray="4,2"/>
    <text x="140" y="153" font-family="Arial, sans-serif" font-size="10" fill="#9b59b6">11×</text>

    <line x1="650" y1="47" x2="650" y2="190" stroke="#9b59b6" stroke-width="1" stroke-dasharray="4,2"/>
    <text x="620" y="118" font-family="Arial, sans-serif" font-size="10" fill="#9b59b6">2.6×</text>

    <!-- CRDT sweet spot annotation -->
    <rect x="0" y="0" width="180" height="280" fill="#27ae60" opacity="0.1"/>
    <text x="90" y="-10" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#1e8449" font-weight="bold">
      CRDT Sweet Spot
    </text>
  </g>

  <!-- Legend -->
  <g transform="translate(550, 90)">
    <rect x="0" y="0" width="180" height="60" fill="#fff" stroke="#bdc3c7" rx="5"/>
    <line x1="15" y1="20" x2="45" y2="20" stroke="#e74c3c" stroke-width="3"/>
    <text x="55" y="24" font-family="Arial, sans-serif" font-size="10" fill="#2c3e50">serde (parses all)</text>
    <line x1="15" y1="42" x2="45" y2="42" stroke="#27ae60" stroke-width="3"/>
    <text x="55" y="46" font-family="Arial, sans-serif" font-size="10" fill="#2c3e50">fionn (schema)</text>
  </g>

  <!-- Insight box -->
  <g transform="translate(50, 385)">
    <rect x="0" y="0" width="800" height="55" fill="#fff" stroke="#bdc3c7" rx="5"/>
    <text x="15" y="18" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#2c3e50">Key Insight:</text>
    <text x="15" y="35" font-family="Arial, sans-serif" font-size="10" fill="#34495e">
      • CRDT operations typically touch 1-10% of fields → 11-35× speedup over serde
    </text>
    <text x="15" y="50" font-family="Arial, sans-serif" font-size="10" fill="#34495e">
      • serde's latency is constant regardless of selectivity (must parse all fields)
    </text>
  </g>
</svg>
