<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 480">
  <defs>
    <linearGradient id="simdGrad" x1="0%" y1="100%" x2="0%" y2="0%">
      <stop offset="0%" style="stop-color:#3498db"/>
      <stop offset="100%" style="stop-color:#2980b9"/>
    </linearGradient>
    <linearGradient id="skipGrad" x1="0%" y1="100%" x2="0%" y2="0%">
      <stop offset="0%" style="stop-color:#27ae60"/>
      <stop offset="100%" style="stop-color:#1e8449"/>
    </linearGradient>
    <linearGradient id="schemaGrad" x1="0%" y1="100%" x2="0%" y2="0%">
      <stop offset="0%" style="stop-color:#9b59b6"/>
      <stop offset="100%" style="stop-color:#8e44ad"/>
    </linearGradient>
    <linearGradient id="parallelGrad" x1="0%" y1="100%" x2="0%" y2="0%">
      <stop offset="0%" style="stop-color:#e74c3c"/>
      <stop offset="100%" style="stop-color:#c0392b"/>
    </linearGradient>
  </defs>

  <!-- Background -->
  <rect width="900" height="480" fill="#fafafa"/>

  <!-- Title -->
  <text x="450" y="30" text-anchor="middle" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="#2c3e50">
    Speedup Breakdown: Contribution of Each Technique
  </text>
  <text x="450" y="48" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#7f8c8d">
    Cumulative speedup over serde_json baseline (1.0×)
  </text>

  <!-- Left chart: Stacked bar showing contributions -->
  <g transform="translate(80, 80)">
    <text x="150" y="-10" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#2c3e50">
      Technique Contributions
    </text>

    <!-- Y-axis -->
    <line x1="0" y1="0" x2="0" y2="280" stroke="#bdc3c7" stroke-width="2"/>

    <!-- Y-axis labels -->
    <text x="-10" y="280" text-anchor="end" font-family="Arial, sans-serif" font-size="10" fill="#7f8c8d">1×</text>
    <text x="-10" y="224" text-anchor="end" font-family="Arial, sans-serif" font-size="10" fill="#7f8c8d">29.5×</text>
    <text x="-10" y="168" text-anchor="end" font-family="Arial, sans-serif" font-size="10" fill="#7f8c8d">50×</text>
    <text x="-10" y="112" text-anchor="end" font-family="Arial, sans-serif" font-size="10" fill="#7f8c8d">100×</text>
    <text x="-10" y="56" text-anchor="end" font-family="Arial, sans-serif" font-size="10" fill="#7f8c8d">150×</text>
    <text x="-10" y="0" text-anchor="end" font-family="Arial, sans-serif" font-size="10" fill="#7f8c8d">200×</text>

    <!-- Gridlines -->
    <line x1="0" y1="224" x2="300" y2="224" stroke="#ecf0f1" stroke-width="1"/>
    <line x1="0" y1="168" x2="300" y2="168" stroke="#ecf0f1" stroke-width="1"/>
    <line x1="0" y1="112" x2="300" y2="112" stroke="#ecf0f1" stroke-width="1"/>
    <line x1="0" y1="56" x2="300" y2="56" stroke="#ecf0f1" stroke-width="1"/>

    <!-- Stacked bar -->
    <!-- Base: 1× (serde_json) - not shown, starts at bottom -->

    <!-- SIMD scanning: +5× (total 6×) - height = 5/200 * 280 = 7 -->
    <rect x="100" y="273" width="100" height="7" fill="url(#simdGrad)" stroke="#2980b9" stroke-width="1"/>

    <!-- Skip processing: +74× (total 80×) - height = 74/200 * 280 = 103.6 -->
    <rect x="100" y="169" width="100" height="104" fill="url(#skipGrad)" stroke="#1e8449" stroke-width="1"/>

    <!-- Schema filtering: +76× (total 156×) - height = 76/200 * 280 = 106.4 -->
    <rect x="100" y="63" width="100" height="106" fill="url(#schemaGrad)" stroke="#8e44ad" stroke-width="1"/>

    <!-- Parallel (potential): +44× (total 200×) - height = 44/200 * 280 = 61.6 -->
    <rect x="100" y="1" width="100" height="62" fill="url(#parallelGrad)" stroke="#c0392b" stroke-width="1" stroke-dasharray="3,2"/>

    <!-- Labels on bars -->
    <text x="150" y="278" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="white" font-weight="bold">6×</text>
    <text x="150" y="225" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="white" font-weight="bold">80×</text>
    <text x="150" y="120" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="white" font-weight="bold">156×</text>
    <text x="150" y="35" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="white" font-weight="bold">~200×</text>

    <!-- X-axis -->
    <line x1="0" y1="280" x2="300" y2="280" stroke="#bdc3c7" stroke-width="2"/>
    <text x="150" y="300" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#2c3e50">Cumulative</text>
  </g>

  <!-- Right chart: Horizontal bars showing individual contributions -->
  <g transform="translate(480, 80)">
    <text x="180" y="-10" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#2c3e50">
      Individual Technique Impact
    </text>

    <!-- Y-axis labels -->
    <text x="0" y="45" font-family="Arial, sans-serif" font-size="11" fill="#2c3e50">SIMD Scanning</text>
    <text x="0" y="65" font-family="Arial, sans-serif" font-size="9" fill="#7f8c8d">(simdjson heritage)</text>

    <text x="0" y="115" font-family="Arial, sans-serif" font-size="11" fill="#2c3e50">Skip Processing</text>
    <text x="0" y="135" font-family="Arial, sans-serif" font-size="9" fill="#7f8c8d">(JSONSki heritage)</text>

    <text x="0" y="185" font-family="Arial, sans-serif" font-size="11" fill="#2c3e50">Schema Filtering</text>
    <text x="0" y="205" font-family="Arial, sans-serif" font-size="9" fill="#7f8c8d">(Novel contribution)</text>

    <text x="0" y="255" font-family="Arial, sans-serif" font-size="11" fill="#2c3e50">Parallel Batching</text>
    <text x="0" y="275" font-family="Arial, sans-serif" font-size="9" fill="#7f8c8d">(Rayon work-stealing)</text>

    <!-- Bars - scale: 100px = 100× -->
    <!-- SIMD: 6× -->
    <rect x="140" y="35" width="24" height="30" fill="url(#simdGrad)" rx="3"/>
    <text x="170" y="55" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#2980b9">6×</text>

    <!-- Skip: 80× / 6× = 13.3× multiplier -->
    <rect x="140" y="105" width="133" height="30" fill="url(#skipGrad)" rx="3"/>
    <text x="280" y="125" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#1e8449">13.3× (→80×)</text>

    <!-- Schema: 156× / 80× = 1.95× multiplier -->
    <rect x="140" y="175" width="78" height="30" fill="url(#schemaGrad)" rx="3"/>
    <text x="225" y="195" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#8e44ad">1.95× (→156×)</text>

    <!-- Parallel: varies by core count, ~1.3× on 16 cores -->
    <rect x="140" y="245" width="52" height="30" fill="url(#parallelGrad)" rx="3" stroke-dasharray="3,2" stroke="#c0392b" stroke-width="1"/>
    <text x="200" y="265" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#c0392b">1.3× (→200×)</text>

    <!-- Scale -->
    <line x1="140" y1="295" x2="340" y2="295" stroke="#bdc3c7" stroke-width="1"/>
    <text x="140" y="310" font-family="Arial, sans-serif" font-size="9" fill="#7f8c8d">0×</text>
    <text x="240" y="310" font-family="Arial, sans-serif" font-size="9" fill="#7f8c8d">10×</text>
    <text x="340" y="310" font-family="Arial, sans-serif" font-size="9" fill="#7f8c8d">20×</text>
  </g>

  <!-- Constraint annotations -->
  <g transform="translate(50, 400)">
    <rect x="0" y="0" width="800" height="70" fill="#fff" stroke="#bdc3c7" rx="5"/>
    <text x="15" y="18" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#2c3e50">Limiting Factors:</text>
    <text x="15" y="35" font-family="Arial, sans-serif" font-size="10" fill="#34495e">
      • SIMD: Limited by memory bandwidth, not ALU throughput (AVX2 can process 32B/cycle at 5GHz = 160 GB/s theoretical)
    </text>
    <text x="15" y="50" font-family="Arial, sans-serif" font-size="10" fill="#34495e">
      • Skip: Bracket counting still requires string mask computation; cannot skip faster than structural scan
    </text>
    <text x="15" y="65" font-family="Arial, sans-serif" font-size="10" fill="#34495e">
      • Parallel: Memory bandwidth shared across cores; 16 cores see ~2× speedup, not 16× (Amdahl's law + bandwidth)
    </text>
  </g>
</svg>
