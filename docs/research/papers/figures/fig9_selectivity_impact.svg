<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 450">
  <defs>
    <linearGradient id="lineGrad" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#3498db"/>
      <stop offset="100%" style="stop-color:#9b59b6"/>
    </linearGradient>
  </defs>

  <!-- Background -->
  <rect width="900" height="450" fill="#fafafa"/>

  <!-- Title -->
  <text x="450" y="30" text-anchor="middle" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="#2c3e50">
    Schema Selectivity vs. Speedup
  </text>
  <text x="450" y="48" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#7f8c8d">
    Impact of schema match ratio on skip processing effectiveness
  </text>

  <!-- Chart area -->
  <g transform="translate(100, 80)">
    <!-- Axes -->
    <line x1="0" y1="280" x2="650" y2="280" stroke="#bdc3c7" stroke-width="2"/>
    <line x1="0" y1="0" x2="0" y2="280" stroke="#bdc3c7" stroke-width="2"/>

    <!-- X-axis labels (selectivity %) -->
    <text x="0" y="300" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#7f8c8d">0%</text>
    <text x="130" y="300" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#7f8c8d">20%</text>
    <text x="260" y="300" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#7f8c8d">40%</text>
    <text x="390" y="300" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#7f8c8d">60%</text>
    <text x="520" y="300" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#7f8c8d">80%</text>
    <text x="650" y="300" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#7f8c8d">100%</text>
    <text x="325" y="325" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#2c3e50">
      Schema Selectivity (% of fields matching schema)
    </text>

    <!-- Y-axis labels (speedup) -->
    <text x="-10" y="280" text-anchor="end" font-family="Arial, sans-serif" font-size="10" fill="#7f8c8d">0×</text>
    <text x="-10" y="224" text-anchor="end" font-family="Arial, sans-serif" font-size="10" fill="#7f8c8d">50×</text>
    <text x="-10" y="168" text-anchor="end" font-family="Arial, sans-serif" font-size="10" fill="#7f8c8d">100×</text>
    <text x="-10" y="112" text-anchor="end" font-family="Arial, sans-serif" font-size="10" fill="#7f8c8d">150×</text>
    <text x="-10" y="56" text-anchor="end" font-family="Arial, sans-serif" font-size="10" fill="#7f8c8d">200×</text>
    <text x="-10" y="0" text-anchor="end" font-family="Arial, sans-serif" font-size="10" fill="#7f8c8d">250×</text>

    <text x="-50" y="140" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#2c3e50" transform="rotate(-90, -50, 140)">
      Speedup vs. serde_json
    </text>

    <!-- Gridlines -->
    <line x1="0" y1="224" x2="650" y2="224" stroke="#ecf0f1" stroke-width="1"/>
    <line x1="0" y1="168" x2="650" y2="168" stroke="#ecf0f1" stroke-width="1"/>
    <line x1="0" y1="112" x2="650" y2="112" stroke="#ecf0f1" stroke-width="1"/>
    <line x1="0" y1="56" x2="650" y2="56" stroke="#ecf0f1" stroke-width="1"/>

    <line x1="130" y1="0" x2="130" y2="280" stroke="#ecf0f1" stroke-width="1"/>
    <line x1="260" y1="0" x2="260" y2="280" stroke="#ecf0f1" stroke-width="1"/>
    <line x1="390" y1="0" x2="390" y2="280" stroke="#ecf0f1" stroke-width="1"/>
    <line x1="520" y1="0" x2="520" y2="280" stroke="#ecf0f1" stroke-width="1"/>

    <!-- Regions -->
    <!-- High skip benefit (0-20% selectivity) -->
    <rect x="0" y="0" width="130" height="280" fill="#27ae60" opacity="0.1"/>
    <text x="65" y="20" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#27ae60" font-weight="bold">
      HIGH SKIP
    </text>
    <text x="65" y="32" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#27ae60">
      BENEFIT
    </text>

    <!-- Moderate benefit (20-60% selectivity) -->
    <rect x="130" y="0" width="260" height="280" fill="#f39c12" opacity="0.1"/>
    <text x="260" y="20" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#d68910" font-weight="bold">
      MODERATE BENEFIT
    </text>

    <!-- Low benefit (60-100% selectivity) -->
    <rect x="390" y="0" width="260" height="280" fill="#e74c3c" opacity="0.1"/>
    <text x="520" y="20" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#c0392b" font-weight="bold">
      LOW SKIP BENEFIT
    </text>

    <!-- Curve: Speedup = 250 * (1 - selectivity)^0.7 + 6 -->
    <!-- At 0%: 256×, At 10%: ~180×, At 20%: ~140×, At 50%: ~75×, At 100%: 6× -->
    <path d="M 0,2
             Q 65,30 130,112
             Q 195,160 260,190
             Q 325,210 390,230
             Q 455,250 520,260
             L 650,273"
          fill="none" stroke="#3498db" stroke-width="3"/>

    <!-- Data points -->
    <circle cx="0" cy="2" r="6" fill="#3498db"/>
    <text x="15" y="0" font-family="Arial, sans-serif" font-size="10" fill="#2980b9" font-weight="bold">~250×</text>

    <circle cx="65" cy="56" r="5" fill="#3498db"/>
    <text x="80" y="54" font-family="Arial, sans-serif" font-size="9" fill="#2980b9">~200×</text>

    <circle cx="130" cy="112" r="5" fill="#3498db"/>
    <text x="145" y="110" font-family="Arial, sans-serif" font-size="9" fill="#2980b9">156×</text>

    <circle cx="260" cy="190" r="5" fill="#3498db"/>
    <text x="275" y="188" font-family="Arial, sans-serif" font-size="9" fill="#2980b9">80×</text>

    <circle cx="390" cy="230" r="5" fill="#3498db"/>
    <text x="405" y="228" font-family="Arial, sans-serif" font-size="9" fill="#2980b9">~40×</text>

    <circle cx="520" cy="260" r="5" fill="#3498db"/>
    <text x="535" y="258" font-family="Arial, sans-serif" font-size="9" fill="#2980b9">~15×</text>

    <circle cx="650" cy="273" r="6" fill="#3498db"/>
    <text x="620" y="268" font-family="Arial, sans-serif" font-size="10" fill="#2980b9" font-weight="bold">6×</text>

    <!-- simd-json baseline -->
    <line x1="0" y1="273" x2="650" y2="273" stroke="#f39c12" stroke-width="2" stroke-dasharray="5,3"/>
    <text x="660" y="277" font-family="Arial, sans-serif" font-size="9" fill="#d68910">simd-json (6×)</text>

    <!-- Crossover annotation -->
    <line x1="580" y1="273" x2="580" y2="290" stroke="#7f8c8d" stroke-width="1"/>
    <text x="580" y="305" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#7f8c8d">
      Crossover: ~90%
    </text>
  </g>

  <!-- Insight box -->
  <g transform="translate(50, 380)">
    <rect x="0" y="0" width="800" height="60" fill="#fff" stroke="#bdc3c7" rx="5"/>
    <text x="15" y="18" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#2c3e50">Selectivity Insight:</text>
    <text x="15" y="35" font-family="Arial, sans-serif" font-size="10" fill="#34495e">
      • Typical CRDT operations touch 5-20% of fields → 150-200× speedup range (ideal for fionn)
    </text>
    <text x="15" y="50" font-family="Arial, sans-serif" font-size="10" fill="#34495e">
      • Full document deserialization (100% selectivity) → 6× speedup (same as simd-json, no skip benefit)
    </text>
  </g>
</svg>
